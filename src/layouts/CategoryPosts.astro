---
import { Image } from '@astrojs/image/components';
import BaseHead from '../components/BaseHead.astro';
import Body from '../components/Body.astro';
import Breadcrumb from '../components/Breadcrumb.astro';
import Header from '../components/Header.astro';
import Masthead from '../components/Masthead.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../consts';
import Content from '../components/Content.astro';

export interface Props {
  category: string
}

const { category } = Astro.props
const posts = (await Astro.glob('../pages/posts/*.md'))
  .sort(
    (a, b) =>
      new Date(b.frontmatter.createdAt).valueOf() -
      new Date(a.frontmatter.createdAt).valueOf()
  )
  .filter(item => item.frontmatter.tags.includes(category))
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION}/>
  </head>
  <Body>
    <Header title={SITE_TITLE} />
    <main class="pt-[56px]">
      <Masthead />
      <Content>
        <Breadcrumb>{category}</Breadcrumb>
        <section>
          <ul class="grid grid-cols-1 md:grid-cols-2 gap-4"> {
            posts.map(post => {
              return <li class="list-none text-center mx-auto">
                <a href={post.url}>
                  <Image 
                    class="border border-slate-300 dark:border-zinc-700 rounded-xl" 
                    src={post.frontmatter.heroImage} 
                    width={720 * 2} 
                    format="jpg"
                    aspectRatio={2.0}
                    alt="Thumbnail"
                  />
                  <div class="mt-3 text-xl">
                    {post.frontmatter.title}
                  </div>
                  <div class="opacity-70">
                    {post.frontmatter.description}
                  </div>
                  <br />
                </a>
              </li>
              })
            }
          </ul>
        </section>
      <Content />
    </main>
  </Body>
</html>
